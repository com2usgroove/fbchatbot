{"version":3,"sources":["../../../server/authEndpoint/question.js"],"names":["init","app","dh","get","req","res","getQuestionFlow","then","questionFlow","json","questions","catch","err","info","JSON","stringify","sendStatus","post","Array","isArray","body","save","LEADGENBOT_QUESTIONAIRE_UPDATE"],"mappings":";;;;;QAKgBA,I,GAAAA,I;;AALhB;;;;AAEA;;;;AACA;;;;AAEO,SAASA,IAAT,CAAcC,GAAd,EAAmBC,EAAnB,EAAuB;AAC5BD,MAAIE,GAAJ,CAAQ,YAAR,EAAsB,UAACC,GAAD,EAAMC,GAAN,EAAc;AAClCH,OAAGI,eAAH,GACGC,IADH,CACQ,UAACC,YAAD,EAAkB;AACtBH,UAAII,IAAJ,CAASD,aAAaE,SAAtB;AACD,KAHH,EAIGC,KAJH,CAIS,UAACC,GAAD,EAAS;AACd,uBAAOC,IAAP,gCAAyCC,KAAKC,SAAL,CAAeH,GAAf,CAAzC;AACAP,UAAIW,UAAJ,CAAe,GAAf;AACD,KAPH;AAQD,GATD;;AAWAf,MAAIgB,IAAJ,CAAS,YAAT,EAAuB,UAACb,GAAD,EAAMC,GAAN,EAAc;AACnC,6BAAUa,MAAMC,OAAN,CAAcf,IAAIgB,IAAlB,CAAV,EAAmC,+DAAnC;AACAlB,OAAGI,eAAH,GACGC,IADH,CACQ,UAACC,YAAD,EAAkB;AACtBA,mBAAaE,SAAb,GAAyBN,IAAIgB,IAA7B;AACA,aAAOZ,aAAaa,IAAb,EAAP;AACD,KAJH,EAKGd,IALH,CAKQ,YAAM;AACVF,UAAIW,UAAJ,CAAe,GAAf;AACD,KAPH,EAQGL,KARH,CAQS,YAAM;AACXN,UAAIW,UAAJ,CAAe,GAAf;AACD,KAVH;AAWA,oBAAK,iBAAWM,8BAAhB;AACD,GAdD;AAeD","file":"question.js","sourcesContent":["import invariant from 'invariant';\n\nimport logger from 'common/logger';\nimport { fbtrEvents, fbtr } from 'common/fbtr';\n\nexport function init(app, dh) {\n  app.get('/questions', (req, res) => {\n    dh.getQuestionFlow()\n      .then((questionFlow) => {\n        res.json(questionFlow.questions);\n      })\n      .catch((err) => {\n        logger.info(`Get all questions failed: ${JSON.stringify(err)}`);\n        res.sendStatus(500);\n      });\n  });\n\n  app.post('/questions', (req, res) => {\n    invariant(Array.isArray(req.body), '/questions only accepts POST with JSON array. Current is not!');\n    dh.getQuestionFlow()\n      .then((questionFlow) => {\n        questionFlow.questions = req.body;\n        return questionFlow.save();\n      })\n      .then(() => {\n        res.sendStatus(200);\n      })\n      .catch(() => {\n        res.sendStatus(500);\n      });\n    fbtr(fbtrEvents.LEADGENBOT_QUESTIONAIRE_UPDATE);\n  });\n}\n"]}